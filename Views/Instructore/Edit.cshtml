@model CreateInstructoreViewModel
@{
    ViewData["Title"] = "Edit";
}

<h1>Edit</h1>

<a class="btn btn-primary" href="/instructore">Instructors</a>


<form action="/Instructore/update/@Model.Id" method="post">
    <div class="mb-3">
        <label for="name" class="form-label">Name</label>
        <input type="text" class="form-control" id="name" name="Name" value="@Model?.Name" required>
    </div>
    <div class="mb-3">
        <label for="imageUrl" class="form-label">Image URL</label>
        <input type="text" class="form-control" id="imageUrl" name="Image" value="@Model?.Image" required>
    </div>
    <div class="mb-3">
        <label for="salary" class="form-label">Salary</label>
        <input type="number" class="form-control" id="salary" name="Salary" value="@Model?.Salary" required>
    </div>
    <div class="mb-3">
        <label for="address" class="form-label">Address</label>
        <input type="text" class="form-control" id="name" name="Address" value="@Model?.Address">
    </div>
    <div class="mb-3">
        <label for="department" class="form-label">Department</label>
        <select class="form-select" id="DepartmentId" name="DepartmentId" required>
            @foreach (var dep in Model.Departments)
            {
                @if (@dep.Id == Model.DepartmentId)
                {
                    <option value="@dep.Id" selected>@dep.Name</option>
                }else
                {
                    <option value="@dep.Id">@dep.Name</option>
                }
                
            }
        </select>
    </div>
    <div class="mb-3">
        <label for="course" class="form-label">Course</label>
        <select class="form-select" id="CourseId" name="CourseId" required>
            @foreach (var crs in Model.Courses.Where(x => x.DepartmentId == Model.DepartmentId).ToList() )
            {
                @if (@crs.Id == Model.CourseId)
                {
                    <option value="@crs.Id" selected>@crs.Name</option>
                }
                else
                {
                    <option value="@crs.Id">@crs.Name</option>
                }
                
            }
        </select>
    </div>
    <button type="submit" class="btn btn-primary">Update Instructor</button>
</form>

<script src="~/lib/jquery/dist/jquery.min.js"></script>
<script>
    $('#DepartmentId').change(function () {
        let deptID = this.value;
        console.log(deptID);
        let courseSelectBox = document.getElementById("CourseId")
        courseSelectBox.innerHTML = "";
        $.ajax({
            url: "/Instructore/GetCourses?deptID=" + deptID,
            success: function (result) {
                for (let item of result) {
                    courseSelectBox.innerHTML += "<option value=" + item.id + ">" + item.name + "</option>";
                }
            }
        });
    });
</script>